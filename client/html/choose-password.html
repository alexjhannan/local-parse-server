<!doctype html>
<html>
<head>
</head>

<body>
	<h3>Reset Password</h3>
	<form method="POST" action="/choosepassword">
		<label>Password: </label>
		<input name="password" type="password" />
		<br />
		<br />
		<label>Confirm: &nbsp;</label>
		<input name="confirm" type="password" />
		<br />
		<br />
		<input id="email" name="email" type="hidden" />
		<input id="hash" name="hash" type="hidden" />
		<input type="submit" value="Save" />
	</form>

	<script language='javascript' type='text/javascript'>
		// script taken from parse server example
		window.onload = function() {
			var urlParams = {};
			(function () {
				var pair, // Really a match. Index 0 is the full match; 1 & 2 are the key & val.
				tokenize = /([^&=]+)=?([^&]*)/g,
				// decodeURIComponents escapes everything but will leave +s that should be ' '
				re_space = function (s) { return decodeURIComponent(s.replace(/\+/g, " ")); },
				// Substring to cut off the leading '?'
				querystring = window.location.search.substring(1);

				while (pair = tokenize.exec(querystring))
				urlParams[re_space(pair[1])] = re_space(pair[2]);
			})();

			// set hidden inputs of form to hold url query parameters
			document.getElementById('email').value = urlParams['email'];
			document.getElementById('hash').value = urlParams['hash'];
		}
	</script>
</body>

</html>